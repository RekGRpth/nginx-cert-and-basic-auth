This is an example of an nginx configuration with:

* forward http to https
* restrict access to a subdirectory
* authenticate by client certificate
* fallback to basic auth when certificate is not available

For creating client cert see [mini tutorial from mtigas](https://gist.github.com/mtigas/952344)
